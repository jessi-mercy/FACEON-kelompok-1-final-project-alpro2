{% extends "base.html" %}

{% block title %}Demo - faceon{% endblock %}

{% block content %} 
<section class="upload-section">
    <div class="container">
        <div class="section-header">
            <h1>Try <span class="highlight">faceon</span> now by uploading a local image, or by opening your camera.</h1>
        </div>
        
        <div class="upload-container">
            <div class="upload-card">
                <form id="upload-form" action="{{ url_for('predict') }}" method="POST" enctype="multipart/form-data">
                    <input type="file" id="file-input" name="image" accept="image/*" hidden>
                    <div class="image-preview-area" id="upload-area">
                        <div class="image-placeholder-box">
                            <i class="fas fa-camera"></i>
                        </div>
                        <img id="preview-image" src="" alt="Preview" style="display: none;">
                    </div>
                    <div class="upload-buttons">
                        <button type="button" id="camera-btn" class="btn btn-primary">
                            USE MY CAMERA
                        </button>
                        <button type="button" id="upload-btn" class="btn btn-primary">
                            UPLOAD IMAGE
                        </button>
                        <button type="submit" class="btn btn-primary" id="analyze-btn" disabled>
                            SEE RESULTS
                        </button>
                    </div>
                </form>
            </div>

            <!-- Camera Modal -->
            <div id="camera-modal" class="camera-modal" style="display: none;">
                <div class="camera-container">
                    <div class="camera-preview">
                        <video id="camera-video" autoplay playsinline></video>
                        <canvas id="camera-canvas" style="display: none;"></canvas>
                    </div>
                    <div class="camera-controls">
                        <button id="capture-btn" class="btn btn-primary">
                            <i class="fas fa-camera"></i> Capture
                        </button>
                        <button id="close-camera" class="btn btn-secondary">
                            Close
                        </button>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading" class="loading-state" style="display: none;">
                <div class="loading-spinner"></div>
                <h3>Analyzing facial expression...</h3>
                <p>Model CNN is processing your image</p>
            </div>

            <!-- Result Preview -->
            <div id="result-preview" class="result-preview" style="display: none;"></div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/upload.js') }}"></script>
<script src="{{ url_for('static', filename='js/camera.js') }}"></script>
{% endblock %}